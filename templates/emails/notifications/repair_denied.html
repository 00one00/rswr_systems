{% extends "emails/base.html" %}

{% block email_title %}Repair Requires Attention - {{ repair.unit_number }}{% endblock %}

{% block preheader %}Your repair request for unit {{ repair.unit_number }} requires additional review or information.{% endblock %}

{% block content %}
<!-- Denial Badge -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="text-align: center; padding-bottom: 20px;">
            <div style="display: inline-block; background-color: {{ branding.danger_color }}; color: white; padding: 10px 20px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 14px; font-weight: bold; letter-spacing: 0.5px;">
                âš  REQUIRES ATTENTION
            </div>
        </td>
    </tr>
</table>

<!-- Main Heading -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding-bottom: 20px;">
            <h1 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 24px; font-weight: bold; line-height: 1.3;">
                Repair Request Requires Review
            </h1>
            <p style="margin: 10px 0 0 0; color: #666666; font-family: {{ branding.body_font }}; font-size: 16px; line-height: 24px;">
                Your windshield repair request needs additional information or review before we can proceed.
            </p>
        </td>
    </tr>
</table>

<!-- Denial Reason (Highlighted) -->
{% if repair.denial_reason %}
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #fff5f5; border-left: 4px solid {{ branding.danger_color }}; border-radius: 0 4px 4px 0; margin-bottom: 30px;">
    <tr>
        <td style="padding: 20px;">
            <h3 style="margin: 0 0 10px 0; color: {{ branding.danger_color }}; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold;">
                Reason for Review:
            </h3>
            <p style="margin: 0; font-family: {{ branding.body_font }}; font-size: 15px; line-height: 22px; color: #555555;">
                {{ repair.denial_reason }}
            </p>
        </td>
    </tr>
</table>
{% endif %}

<!-- Repair Details Card (Collapsible appearance) -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f8f9fa; border-radius: 8px; margin-bottom: 30px;">
    <tr>
        <td style="padding: 25px;">
            <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                <tr>
                    <td style="padding-bottom: 15px; border-bottom: 2px solid #ddd;">
                        <h2 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 18px; font-weight: bold;">
                            Repair Details
                        </h2>
                    </td>
                </tr>
                <tr>
                    <td style="padding-top: 15px;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Repair ID:</strong>
                                    <span style="color: #666666;">#{{ repair.id }}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Unit Number:</strong>
                                    <span style="color: #666666;">{{ repair.unit_number }}</span>
                                </td>
                            </tr>
                            {% if repair.customer %}
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Company:</strong>
                                    <span style="color: #666666;">{{ repair.customer.company_name }}</span>
                                </td>
                            </tr>
                            {% endif %}
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Break Description:</strong>
                                    <span style="color: #666666;">{{ repair.break_description }}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Requested Date:</strong>
                                    <span style="color: #666666;">{{ repair.requested_repair_date|date:"M d, Y" }}</span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- CTA Buttons (Multiple actions) -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 20px;">
    <tr>
        <td style="text-align: center; padding: 20px 0;">
            <!-- Primary CTA -->
            <a href="{{ view_repair_url }}" style="background-color: {{ branding.primary_color }}; color: white; text-decoration: none; padding: 14px 30px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold; display: inline-block; margin: 0 5px 10px 5px;">
                View Full Details
            </a>

            <!-- Secondary CTA -->
            {% if branding.support_email %}
            <a href="mailto:{{ branding.support_email }}?subject=Repair%20%23{{ repair.id }}%20-%20Additional%20Information" style="background-color: white; color: {{ branding.primary_color }}; text-decoration: none; padding: 14px 30px; border: 2px solid {{ branding.primary_color }}; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold; display: inline-block; margin: 0 5px 10px 5px;">
                Contact Us
            </a>
            {% endif %}
        </td>
    </tr>
</table>

<!-- Next Steps -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 30px;">
    <tr>
        <td style="padding-bottom: 15px;">
            <h2 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 18px; font-weight: bold;">
                What Should You Do?
            </h2>
        </td>
    </tr>
    <tr>
        <td>
            <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                <tr>
                    <td style="padding: 12px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 22px; color: #666666;">
                        <span style="display: inline-block; width: 24px; height: 24px; background-color: {{ branding.primary_color }}; color: white; border-radius: 50%; text-align: center; line-height: 24px; font-weight: bold; margin-right: 10px;">1</span>
                        Review the reason for review listed above
                    </td>
                </tr>
                <tr>
                    <td style="padding: 12px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 22px; color: #666666;">
                        <span style="display: inline-block; width: 24px; height: 24px; background-color: {{ branding.primary_color }}; color: white; border-radius: 50%; text-align: center; line-height: 24px; font-weight: bold; margin-right: 10px;">2</span>
                        Contact us with any questions or additional information
                    </td>
                </tr>
                <tr>
                    <td style="padding: 12px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 22px; color: #666666;">
                        <span style="display: inline-block; width: 24px; height: 24px; background-color: {{ branding.primary_color }}; color: white; border-radius: 50%; text-align: center; line-height: 24px; font-weight: bold; margin-right: 10px;">3</span>
                        We'll update you once the issue is resolved
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- Support Note -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding: 20px; background-color: #f0f8ff; border-left: 4px solid {{ branding.secondary_color }}; border-radius: 0 4px 4px 0;">
            <p style="margin: 0; font-family: {{ branding.body_font }}; font-size: 13px; line-height: 20px; color: #555555;">
                <strong style="color: {{ branding.text_color }};">Need Help?</strong>
                {% if branding.support_email %}
                Email us at <a href="mailto:{{ branding.support_email }}" style="color: {{ branding.primary_color }}; text-decoration: none;">{{ branding.support_email }}</a>
                {% endif %}
                {% if branding.support_phone %}
                {% if branding.support_email %} or call {% else %}Call us at {% endif %}
                <a href="tel:{{ branding.support_phone }}" style="color: {{ branding.primary_color }}; text-decoration: none;">{{ branding.support_phone }}</a>
                {% endif %}
                and reference repair #{{ repair.id }}.
            </p>
        </td>
    </tr>
</table>
{% endblock %}

{% block unsubscribe_url %}/app/settings/notifications/{% endblock %}
