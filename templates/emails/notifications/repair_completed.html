{% extends "emails/base.html" %}

{% block email_title %}Repair Completed - {{ repair.unit_number }}{% endblock %}

{% block preheader %}Great news! Your windshield repair for unit {{ repair.unit_number }} has been completed successfully.{% endblock %}

{% block content %}
<!-- Success Badge -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="text-align: center; padding-bottom: 20px;">
            <div style="display: inline-block; background-color: {{ branding.success_color }}; color: white; padding: 10px 20px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 14px; font-weight: bold; letter-spacing: 0.5px;">
                âœ“ COMPLETED
            </div>
        </td>
    </tr>
</table>

<!-- Main Heading -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding-bottom: 20px;">
            <h1 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 24px; font-weight: bold; line-height: 1.3;">
                Repair Completed Successfully! ðŸŽ‰
            </h1>
            <p style="margin: 10px 0 0 0; color: #666666; font-family: {{ branding.body_font }}; font-size: 16px; line-height: 24px;">
                Your windshield has been repaired and is ready to return to service.
            </p>
        </td>
    </tr>
</table>

<!-- Repair Summary Card -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f0fdf4; border: 2px solid {{ branding.success_color }}; border-radius: 8px; margin-bottom: 30px;">
    <tr>
        <td style="padding: 25px;">
            <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                <tr>
                    <td style="padding-bottom: 15px;">
                        <h2 style="margin: 0; color: {{ branding.success_color }}; font-family: {{ branding.heading_font }}; font-size: 18px; font-weight: bold;">
                            Repair Summary
                        </h2>
                    </td>
                </tr>
                <tr>
                    <td>
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Repair ID:</strong>
                                    <span style="color: #666666;">#{{ repair.id }}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Unit Number:</strong>
                                    <span style="color: #666666;">{{ repair.unit_number }}</span>
                                </td>
                            </tr>
                            {% if repair.customer %}
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Company:</strong>
                                    <span style="color: #666666;">{{ repair.customer.company_name }}</span>
                                </td>
                            </tr>
                            {% endif %}
                            {% if repair.assigned_technician %}
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Technician:</strong>
                                    <span style="color: #666666;">{{ repair.assigned_technician.get_full_name }}</span>
                                </td>
                            </tr>
                            {% endif %}
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Completed On:</strong>
                                    <span style="color: #666666;">{{ repair.actual_repair_date|date:"M d, Y" }}</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 8px 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 20px;">
                                    <strong style="color: {{ branding.text_color }};">Total Cost:</strong>
                                    <span style="color: {{ branding.success_color }}; font-weight: bold;">${{ repair.total_cost }}</span>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- Before/After Photos (if available) -->
{% if repair.damage_photo_before or repair.damage_photo_after %}
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 30px;">
    <tr>
        <td style="padding-bottom: 15px;">
            <h2 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 18px; font-weight: bold;">
                Repair Documentation
            </h2>
        </td>
    </tr>
    <tr>
        <td>
            <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                <tr>
                    {% if repair.damage_photo_before %}
                    <td width="48%" style="vertical-align: top; padding-right: 2%;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="padding-bottom: 10px; font-family: {{ branding.body_font }}; font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 0.5px;">
                                    Before
                                </td>
                            </tr>
                            <tr>
                                <td style="background-color: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                                    <img src="{{ repair.damage_photo_before.url }}" alt="Before Repair" style="max-width: 100%; height: auto; border-radius: 4px;">
                                </td>
                            </tr>
                        </table>
                    </td>
                    {% endif %}
                    {% if repair.damage_photo_after %}
                    <td width="{% if repair.damage_photo_before %}48%{% else %}100%{% endif %}" style="vertical-align: top; {% if repair.damage_photo_before %}padding-left: 2%;{% endif %}">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="padding-bottom: 10px; font-family: {{ branding.body_font }}; font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 0.5px;">
                                    After
                                </td>
                            </tr>
                            <tr>
                                <td style="background-color: #f8f9fa; padding: 10px; border-radius: 8px; text-align: center;">
                                    <img src="{{ repair.damage_photo_after.url }}" alt="After Repair" style="max-width: 100%; height: auto; border-radius: 4px;">
                                </td>
                            </tr>
                        </table>
                    </td>
                    {% endif %}
                </tr>
            </table>
        </td>
    </tr>
</table>
{% endif %}

<!-- CTA Button -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 20px;">
    <tr>
        <td style="text-align: center; padding: 20px 0;">
            <a href="{{ view_repair_url }}" style="background-color: {{ branding.primary_color }}; color: white; text-decoration: none; padding: 14px 35px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold; display: inline-block;">
                View Complete Details
            </a>
        </td>
    </tr>
</table>

<!-- Thank You Note -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding: 20px; background-color: #f0f8ff; border-left: 4px solid {{ branding.secondary_color }}; border-radius: 0 4px 4px 0;">
            <p style="margin: 0; font-family: {{ branding.body_font }}; font-size: 14px; line-height: 22px; color: #555555;">
                <strong style="color: {{ branding.text_color }};">Thank you for choosing {{ branding.company_name }}!</strong><br>
                If you have any questions about this repair or need additional service, please don't hesitate to reach out.
                {% if branding.support_email %}<br><br>Contact us at <a href="mailto:{{ branding.support_email }}" style="color: {{ branding.primary_color }}; text-decoration: none;">{{ branding.support_email }}</a>{% endif %}
                {% if branding.support_phone %} or <a href="tel:{{ branding.support_phone }}" style="color: {{ branding.primary_color }}; text-decoration: none;">{{ branding.support_phone }}</a>{% endif %}
            </p>
        </td>
    </tr>
</table>
{% endblock %}

{% block unsubscribe_url %}/app/settings/notifications/{% endblock %}
