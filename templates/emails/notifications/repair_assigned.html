{% extends "emails/base.html" %}

{% block email_title %}New Repair Assigned - {{ repair.unit_number }}{% endblock %}

{% block preheader %}You've been assigned to repair unit {{ repair.unit_number }}.{% endblock %}

{% block content %}
<!-- Assignment Badge -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="text-align: center; padding-bottom: 20px;">
            <div style="display: inline-block; background: linear-gradient(135deg, {{ branding.primary_color }} 0%, {{ branding.secondary_color }} 100%); color: white; padding: 10px 20px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 14px; font-weight: bold; letter-spacing: 0.5px;">
                üìã NEW ASSIGNMENT
            </div>
        </td>
    </tr>
</table>

<!-- Main Heading -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding-bottom: 20px;">
            <h1 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 24px; font-weight: bold; line-height: 1.3;">
                New Repair Assigned
            </h1>
            <p style="margin: 10px 0 0 0; color: #666666; font-family: {{ branding.body_font }}; font-size: 16px; line-height: 24px;">
                You've been assigned to a new windshield repair. Please review the details below.
            </p>
        </td>
    </tr>
</table>

<!-- Repair Details Card (Gradient header) -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background: linear-gradient(135deg, {{ branding.primary_color }} 0%, {{ branding.secondary_color }} 100%); border-radius: 8px 8px 0 0; margin-bottom: 0;">
    <tr>
        <td style="padding: 20px; text-align: center;">
            <h2 style="margin: 0; color: white; font-family: {{ branding.heading_font }}; font-size: 20px; font-weight: bold;">
                Repair #{{ repair.id }}
            </h2>
            <p style="margin: 5px 0 0 0; color: rgba(255,255,255,0.9); font-size: 14px;">
                Unit {{ repair.unit_number }}
            </p>
        </td>
    </tr>
</table>

<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="background-color: #f8f9fa; border-radius: 0 0 8px 8px; margin-bottom: 30px;">
    <tr>
        <td style="padding: 25px;">
            <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                <!-- Customer Info -->
                {% if repair.customer %}
                <tr>
                    <td style="padding: 12px 0; border-bottom: 1px solid #e0e0e0;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="font-family: {{ branding.body_font }}; font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 0.5px; padding-bottom: 5px;">
                                    Customer
                                </td>
                            </tr>
                            <tr>
                                <td style="font-family: {{ branding.heading_font }}; font-size: 16px; color: {{ branding.text_color }}; font-weight: bold;">
                                    {{ repair.customer.company_name }}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                {% endif %}

                <!-- Break Description -->
                <tr>
                    <td style="padding: 12px 0; border-bottom: 1px solid #e0e0e0;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td style="font-family: {{ branding.body_font }}; font-size: 12px; color: #999; text-transform: uppercase; letter-spacing: 0.5px; padding-bottom: 5px;">
                                    Break Description
                                </td>
                            </tr>
                            <tr>
                                <td style="font-family: {{ branding.body_font }}; font-size: 15px; color: #555; line-height: 22px;">
                                    {{ repair.break_description }}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Requested Date -->
                <tr>
                    <td style="padding: 12px 0; border-bottom: 1px solid #e0e0e0;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td width="50%" style="font-family: {{ branding.body_font }}; font-size: 14px; color: {{ branding.text_color }};">
                                    <strong>Requested Date:</strong>
                                </td>
                                <td width="50%" style="font-family: {{ branding.body_font }}; font-size: 14px; color: #666; text-align: right;">
                                    {{ repair.requested_repair_date|date:"M d, Y" }}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <!-- Cost -->
                <tr>
                    <td style="padding: 12px 0;">
                        <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
                            <tr>
                                <td width="50%" style="font-family: {{ branding.body_font }}; font-size: 14px; color: {{ branding.text_color }};">
                                    <strong>Repair Cost:</strong>
                                </td>
                                <td width="50%" style="font-family: {{ branding.heading_font }}; font-size: 18px; color: {{ branding.success_color }}; font-weight: bold; text-align: right;">
                                    ${{ repair.total_cost }}
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<!-- Damage Photo (if available) -->
{% if repair.damage_photo_before %}
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 30px;">
    <tr>
        <td style="padding-bottom: 10px;">
            <h3 style="margin: 0; color: {{ branding.text_color }}; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold;">
                Damage Photo
            </h3>
        </td>
    </tr>
    <tr>
        <td style="text-align: center; background-color: #f8f9fa; padding: 20px; border-radius: 8px;">
            <img src="{{ repair.damage_photo_before.url }}" alt="Windshield Damage" style="max-width: 100%; height: auto; border-radius: 4px; border: 2px solid #ddd;">
        </td>
    </tr>
</table>
{% endif %}

<!-- CTA Button -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 20px;">
    <tr>
        <td style="text-align: center; padding: 20px 0;">
            <a href="{{ view_repair_url }}" style="background-color: {{ branding.primary_color }}; color: white; text-decoration: none; padding: 16px 40px; border-radius: {{ branding.button_border_radius }}px; font-family: {{ branding.heading_font }}; font-size: 16px; font-weight: bold; display: inline-block;">
                View Full Details & Start Repair
            </a>
        </td>
    </tr>
</table>

<!-- Important Note -->
<table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%">
    <tr>
        <td style="padding: 20px; background-color: #fff8e6; border-left: 4px solid #f59e0b; border-radius: 0 4px 4px 0;">
            <p style="margin: 0; font-family: {{ branding.body_font }}; font-size: 13px; line-height: 20px; color: #555555;">
                <strong style="color: {{ branding.text_color }};">‚è∞ Action Required:</strong>
                Please review this repair assignment and update the status once you begin work. The customer is waiting for your update.
            </p>
        </td>
    </tr>
</table>
{% endblock %}

{% block unsubscribe_url %}/tech/settings/notifications/{% endblock %}
